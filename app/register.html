<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register - UUM FoodHunt</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#F97316">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        primary: '#F97316', // Orange-500
                        secondary: '#FDBA74', // Orange-300
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white text-slate-800 antialiased min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden">

    <!-- Decorative Background Shapes -->
    <div class="absolute top-0 left-0 w-full h-[40%] bg-orange-50 -skew-y-6 transform -translate-y-20 z-0"></div>
    <div class="absolute -top-20 -right-20 w-72 h-72 bg-orange-100 rounded-full blur-3xl opacity-50 z-0"></div>
    
    <div class="z-10 w-full max-w-sm">
        
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-slate-900 mb-2">Join the Hunt üçî</h1>
            <p class="text-slate-500">Create an account to start reviewing.</p>
        </div>

        <!-- Register Form -->
        <form onsubmit="return false;" class="space-y-4 bg-white/50 backdrop-blur-sm p-1 rounded-2xl">
            
             <div>
                <label class="block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2 pl-1">Username</label>
                <div class="relative group">
                     <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                         <i class="fa-regular fa-user text-slate-400 group-focus-within:text-primary transition-colors"></i>
                    </div>
                    <input id="username" type="text" placeholder="Pick a username" class="w-full pl-11 pr-4 py-3.5 bg-slate-50 border border-slate-100 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all font-medium text-slate-800 placeholder-slate-400" required>
                </div>
            </div>

            <div>
                <label class="block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2 pl-1">Email</label>
                <div class="relative group">
                     <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                         <i class="fa-regular fa-envelope text-slate-400 group-focus-within:text-primary transition-colors"></i>
                    </div>
                    <input id="email" type="email" placeholder="student@uum.edu.my (Optional)" class="w-full pl-11 pr-4 py-3.5 bg-slate-50 border border-slate-100 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all font-medium text-slate-800 placeholder-slate-400">
                </div>
            </div>

            <div>
                 <label class="block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2 pl-1">Password</label>
                 <div class="relative group">
                     <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                         <i class="fa-solid fa-lock text-slate-400 group-focus-within:text-primary transition-colors"></i>
                    </div>
                    <input id="password" type="password" placeholder="Create password" class="w-full pl-11 pr-4 py-3.5 bg-slate-50 border border-slate-100 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all font-medium text-slate-800 placeholder-slate-400" required>
                </div>
            </div>

            <button id="registerBtn" class="w-full bg-slate-900 text-white py-3.5 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl hover:-translate-y-1 active:scale-95 transition-all mt-6">
                Create Account
            </button>
        </form>

        <!-- Footer -->
        <p class="text-center mt-8 text-slate-500 text-sm">
            Already have an account? <a href="login.html" class="text-primary font-bold hover:underline transition-colors">Sign In</a>
        </p>

    </div>

    <!-- Toast -->
    <div id="toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white px-6 py-3 rounded-full shadow-2xl hidden items-center justify-center z-50 min-w-[200px] transition-opacity">
         <span id="toastMsg" class="text-sm font-medium">Message</span>
    </div>

<script>
function showToast(msg, isError = false) {
    const toast = document.getElementById('toast');
    const msgSpan = document.getElementById('toastMsg');
    msgSpan.textContent = msg;
    msgSpan.innerHTML = isError ? `<i class="fa-solid fa-circle-exclamation text-red-400 mr-2"></i> ${msg}` : `<i class="fa-solid fa-circle-check text-green-400 mr-2"></i> ${msg}`;
    toast.classList.remove('hidden');
    setTimeout(() => {
        toast.classList.add('hidden');
    }, 3000);
}

document.getElementById("registerBtn").addEventListener("click", async (e) => {
  const btn = e.target.closest('button');
  const originalText = btn.innerText;

  const username = document.getElementById("username").value.trim();
  const email = document.getElementById("email").value.trim();
  const password = document.getElementById("password").value.trim();

  if(!username || !password){
    showToast("Username and password required!", true);
    return;
  }

  btn.disabled = true;
  btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i>';

  try {
    const formData = new FormData();
    formData.append('username', username);
    formData.append('password', password);
    formData.append('email', email);

    const response = await fetch('../register.php', {
      method: 'POST',
      body: formData
    });

    const data = await response.json();

    if(data.success){
      showToast("Account created!", false);
      setTimeout(() => {
          window.location.href = "login.html";
      }, 1500);
    } else {
      showToast(data.message || "Registration failed!", true);
      btn.disabled = false;
      btn.innerText = originalText;
    }
  } catch (error) {
    console.error('Registration error:', error);
    showToast("Registration failed. Please try again.", true);
    btn.disabled = false;
    btn.innerText = originalText;
  }
});
</script>

</body>
</html>
