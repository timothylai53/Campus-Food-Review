<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - UUM FoodHunt</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#F97316">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        primary: '#F97316', // Orange-500
                        secondary: '#FDBA74', // Orange-300
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-white text-slate-800 antialiased min-h-screen flex flex-col items-center justify-center p-6 relative overflow-hidden">

    <!-- Decorative Background Shapes -->
    <div class="absolute top-0 left-0 w-full h-[40%] bg-orange-50 -skew-y-6 transform -translate-y-20 z-0"></div>
    <div class="absolute -top-20 -right-20 w-72 h-72 bg-orange-100 rounded-full blur-3xl opacity-50 z-0"></div>
    <div class="absolute top-40 -left-20 w-48 h-48 bg-yellow-100 rounded-full blur-3xl opacity-50 z-0"></div>

    <div class="z-10 w-full max-w-sm">
        
        <!-- Logo & Header -->
        <div class="text-center mb-10">
            <div class="inline-flex items-center justify-center w-20 h-20 rounded-2xl bg-gradient-to-tr from-orange-500 to-rose-500 text-white text-3xl shadow-xl shadow-orange-500/30 mb-6 transform rotate-3">
                <i class="fa-solid fa-utensils"></i>
            </div>
            <h1 class="text-3xl font-bold text-slate-900 mb-2">Welcome Back! ðŸ‘‹</h1>
            <p class="text-slate-500">Sign in to continue your food hunt.</p>
        </div>

        <!-- Login Form -->
        <form onsubmit="return false;" class="space-y-5 bg-white/50 backdrop-blur-sm p-1 rounded-2xl">
            
             <div>
                <label class="block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2 pl-1">Username</label>
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                         <i class="fa-regular fa-user text-slate-400 group-focus-within:text-primary transition-colors"></i>
                    </div>
                    <input id="username" type="text" placeholder="Enter username" class="w-full pl-11 pr-4 py-3.5 bg-slate-50 border border-slate-100 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all font-medium text-slate-800 placeholder-slate-400" required>
                </div>
            </div>

            <div>
                 <label class="block text-xs font-bold text-slate-400 uppercase tracking-wide mb-2 pl-1">Password</label>
                 <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                         <i class="fa-solid fa-lock text-slate-400 group-focus-within:text-primary transition-colors"></i>
                    </div>
                    <input id="password" type="password" placeholder="Enter password" class="w-full pl-11 pr-4 py-3.5 bg-slate-50 border border-slate-100 rounded-xl focus:bg-white focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all font-medium text-slate-800 placeholder-slate-400" required>
                </div>
            </div>

            <button id="loginBtn" class="w-full bg-primary text-white py-3.5 rounded-xl font-bold text-lg shadow-lg shadow-orange-500/30 hover:shadow-orange-500/40 hover:-translate-y-1 active:scale-95 transition-all mt-6 relative overflow-hidden group">
                <span class="relative z-10">Sign In</span>
                <div class="absolute inset-0 bg-white/20 transform -translate-x-full group-hover:translate-x-0 transition-transform duration-300"></div>
            </button>
        </form>

        <!-- Footer -->
        <p class="text-center mt-8 text-slate-500 text-sm">
            Don't have an account? <a href="register.html" class="text-primary font-bold hover:underline transition-colors">Create Account</a>
        </p>

    </div>

    <!-- Error Toast -->
    <div id="errorToast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white px-6 py-3 rounded-full shadow-2xl hidden items-center justify-center z-50 min-w-[200px] transition-opacity">
        <i class="fa-solid fa-circle-exclamation text-red-400 mr-2"></i>
        <span id="errorMsg" class="text-sm font-medium">Error message</span>
    </div>

<script>
function showError(msg) {
    const toast = document.getElementById('errorToast');
    const msgSpan = document.getElementById('errorMsg');
    msgSpan.textContent = msg;
    toast.classList.remove('hidden');
    setTimeout(() => {
        toast.classList.add('hidden');
    }, 3000);
}

document.getElementById("loginBtn").addEventListener("click", async (e) => {
  const btn = e.target.closest('button');
  const originalText = btn.innerHTML;
  
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();
  
  if (!username || !password) {
    showError("Please enter both username and password!");
    return;
  }
  
  // Loading state
  btn.disabled = true;
  btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i>';
  
  try {
    const formData = new FormData();
    formData.append('username', username);
    formData.append('password', password);
    
    // Note: Assuming login.php is in the root directory relative to 'app/' folder
    const response = await fetch('../login.php', {
      method: 'POST',
      body: formData,
      credentials: 'include'
    });
    
    const data = await response.json();
    
    if (data.success) {
      localStorage.setItem("currentUser", username);
      window.location.href = "home.html";
    } else {
      showError(data.message || "Invalid username or password!");
      btn.disabled = false;
      btn.innerHTML = originalText;
    }
  } catch (error) {
    console.error('Login error:', error);
    showError("Login failed. Check connection.");
    btn.disabled = false;
    btn.innerHTML = originalText;
  }
});

// Trigger login on Enter key
document.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        document.getElementById('loginBtn').click();
    }
});
</script>

</body>
</html>
